http_port 3128

pid_filename /run/squid/squid.pid

# ─── No cache ──────────────────────────────────────────────
cache deny all
cache_mem 0

# ─── Log ───────────────────────────────────────────────────
logformat combined %ts.%03tu %>a %un %rm %ru %>Hs %<st %Ss:%Sh
access_log stdio:/var/log/squid/access.log combined
logfile_rotate 8

# ─── ACL ───────────────────────────────────────────────────
acl manager      proto cache_object             # richieste mgr:
acl localnet     src   192.168.0.0/16           # LAN “classica”
acl dockerbridge src 172.18.0.0/16 172.19.0.0/16 172.20.0.0/16 # docker bridge
# acl dockerhost src   172.17.0.1/32            # se vuoi squidclient dall’host

# ─── HTTP ACCESS (l’ordine conta) ──────────────────────────
http_access allow manager localhost
# http_access allow manager dockerhost
http_access allow localnet
http_access allow dockerbridge          # ✱ consenti i container
http_access deny  all
